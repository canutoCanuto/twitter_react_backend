<!DOCTYPE html>
<html lang="en">
  <head>
    <!-- Required meta tags -->
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no" />
    <!-- Bootstrap CSS -->
    <link
      href="https://cdn.jsdelivr.net/npm/bootstrap@5.1.3/dist/css/bootstrap.min.css"
      rel="stylesheet"
      integrity="sha384-1BmE4kWBq78iYhFldvKuhfTAU6auU8tT94WrHftjDbrCEXSU1oBoqyl2QvZ6jIW3"
      crossorigin="anonymous"
    />
    <link rel="stylesheet" href="/css/sideBarLeft.css" />
    <link rel="stylesheet" href="/css/styles.css" />
    <link rel="stylesheet" href="/css/sideBarRight.css" />
    <link
      rel="stylesheet"
      href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.8.1/font/bootstrap-icons.css"
    />
    <title>Home</title>
  </head>
  <body class="centered">
    <%-include('partials/tweetModal.ejs')%>
    <main class="container row">
      <section class="col-3">
        <%-include('partials/sideBarLeft.ejs')%> <%-include('partials/logOut.ejs')%>
      </section>

      <section class="central col-5 border">
        <% for(const tweet of last100Tweets) {%>
        <div class="row border-top border-bottom tweet">
          <div class="col text-light">
            <div class="d-flex pt-3">
              <div class="flex-shrink-0">
                <img
                  src="<%= tweet.author.avatar %>"
                  alt="Avatar"
                  style="width: 50px; height: 50px"
                  class="rounded-circle mb-5"
                />
                <div class="">
                  <% let buttonText = "Follow" %> <% if(postUser.following.indexOf(tweet.author._id)
                  >= 0 ){%> <% buttonText = "unFollow" %> <% } %>
                  <a href="/following/<%= tweet.author._id %> "
                    ><button class="btn btn-dark rounded-pill py-0">
                      <small><%= buttonText %></small>
                    </button>
                  </a>
                </div>
              </div>
              <div class="flex-grow-1 ms-3">
                <p>
                  <span class="fw-bold"
                    ><a href="/<%= tweet.author.username %>"
                      ><%= tweet.author.firstname %> <%= tweet.author.lastname %></a
                    ></span
                  >
                  <span class="text-muted"
                    >@<%=tweet.author.username %> Â· <%= tweet.createdAt %></span
                  >
                </p>
                <p><%= tweet.content %></p>
                <div class="row pb-3">
                  <div class="col-3">
                    <a href="#">
                      <svg
                        xmlns="http://www.w3.org/2000/svg"
                        viewBox="0 0 512 512"
                        class="logo-small"
                      >
                        <path
                          d="M256 32C114.6 32 .0272 125.1 .0272 240c0 47.63 19.91 91.25 52.91 126.2c-14.88 39.5-45.87 72.88-46.37 73.25c-6.625 7-8.375 17.25-4.625 26C5.818 474.2 14.38 480 24 480c61.5 0 109.1-25.75 139.1-46.25C191.1 442.8 223.3 448 256 448c141.4 0 255.1-93.13 255.1-208S397.4 32 256 32zM256.1 400c-26.75 0-53.12-4.125-78.38-12.12l-22.75-7.125l-19.5 13.75c-14.25 10.12-33.88 21.38-57.5 29c7.375-12.12 14.37-25.75 19.88-40.25l10.62-28l-20.62-21.87C69.82 314.1 48.07 282.2 48.07 240c0-88.25 93.25-160 208-160s208 71.75 208 160S370.8 400 256.1 400z"
                        />
                      </svg>
                    </a>
                  </div>
                  <div class="col-3">
                    <a href="#">
                      <svg
                        xmlns="http://www.w3.org/2000/svg"
                        viewBox="0 0 640 512"
                        class="logo-small"
                      >
                        <path
                          d="M614.2 334.8C610.5 325.8 601.7 319.1 592 319.1H544V176C544 131.9 508.1 96 464 96h-128c-17.67 0-32 14.31-32 32s14.33 32 32 32h128C472.8 160 480 167.2 480 176v143.1h-48c-9.703 0-18.45 5.844-22.17 14.82s-1.656 19.29 5.203 26.16l80 80.02C499.7 445.7 505.9 448 512 448s12.28-2.344 16.97-7.031l80-80.02C615.8 354.1 617.9 343.8 614.2 334.8zM304 352h-128C167.2 352 160 344.8 160 336V192h48c9.703 0 18.45-5.844 22.17-14.82s1.656-19.29-5.203-26.16l-80-80.02C140.3 66.34 134.1 64 128 64S115.7 66.34 111 71.03l-80 80.02C24.17 157.9 22.11 168.2 25.83 177.2S38.3 192 48 192H96V336C96 380.1 131.9 416 176 416h128c17.67 0 32-14.31 32-32S321.7 352 304 352z"
                        />
                      </svg>
                    </a>
                  </div>
                  <div class="col-3">
                    <a href="/like/<%= tweet._id %>" class="d-flex align-items-center">
                      <% let heart = "bi-heart"%> <% if(tweet.likes &&
                      tweet.likes.indexOf(postUser._id) >= 0){%> <% heart = "bi-heart-fill"%> <% }
                      %>

                      <i class="bi <%= heart %>"></i>
                      <i class="ms-1"><%= tweet.likes.length %> </i>
                    </a>
                  </div>
                  <div class="col-3">
                    <a href="#">
                      <svg
                        xmlns="http://www.w3.org/2000/svg"
                        viewBox="0 0 448 512"
                        class="logo-small"
                      >
                        <path
                          d="M384 352v64c0 17.67-14.33 32-32 32H96c-17.67 0-32-14.33-32-32v-64c0-17.67-14.33-32-32-32s-32 14.33-32 32v64c0 53.02 42.98 96 96 96h256c53.02 0 96-42.98 96-96v-64c0-17.67-14.33-32-32-32S384 334.3 384 352zM201.4 9.375l-128 128c-12.51 12.51-12.49 32.76 0 45.25c12.5 12.5 32.75 12.5 45.25 0L192 109.3V320c0 17.69 14.31 32 32 32s32-14.31 32-32V109.3l73.38 73.38c12.5 12.5 32.75 12.5 45.25 0s12.5-32.75 0-45.25l-128-128C234.1-3.125 213.9-3.125 201.4 9.375z"
                        />
                      </svg>
                    </a>
                  </div>
                </div>
              </div>
            </div>
          </div>
        </div>
        <% } %>
      </section>
      <section class="sideBarRight col-4 border"><%-include('partials/sideBarRight.ejs')%></section>
    </main>

    <script
      src="https://cdn.jsdelivr.net/npm/bootstrap@5.1.3/dist/js/bootstrap.bundle.min.js"
      integrity="sha384-ka7Sk0Gln4gmtz2MlQnikT1wXgYsOg+OMhuP+IlRH9sENBO0LRn5q+8nbTov4+1p"
      crossorigin="anonymous"
    ></script>
    <script src="./js/home.js"></script>
  </body>
</html>
